# Results

```{r}
library(tidyverse)
library(vcd)
library(ggmap)
library(choroplethr)
```



## Grouped ratings of top rated actor-actress pairs

This graph is a double bar graph that displays the top five ranked actors and actresses (grouped) and their ratings. From this graph you can see that each of the five top rated actors have higher ratings than their female counterparts.

```{r}

graph1 <- read.csv('resources/uploading_data/graph1.csv')

graph1 %>% 
  filter(group <= 5) %>%
  ggplot(aes(x = group, y = ratings, fill = category)) +
  scale_fill_manual(values = c( "lightblue3", "pink")) +
  geom_bar(stat = "identity", position = "dodge") +
  ggtitle("Grouped ratings of top rated actor-actress pairs") +
  ylab("Ratings") +
  xlab("Groups of Actors-Actresses by descending order ratings")

```

## Comparison of Salary of Actors vs Actress

This Cleveland dot plot shows the top 10 ranked actors and actresses (grouped) and their salaries for 2017. From this graph we can see that 8 out of the 10 top actors had a larger salary than their female counterparts. Also noticeable from this graph is the wage difference of over tens of millions of dollars in many groups where actors made more than actresses. In the two groups where actresses made more money than actors, the wage gap was less than ten million dollars.

```{r}

graph2_3 <- read_csv('resources/uploading_data/graph2_3.csv')

graph2_3 %>% 
  ggplot(aes(x = Salary, y = fct_rev(factor(group, level=seq(1:10))), color = category)) +
  geom_point() +
  ggtitle("Comparison of Salary of Actors vs Actress") +
  scale_color_manual(values=c("blue", "red"))+
  ylab("Grouped number")+
  xlab("$Salary In Millions")
```

## Comparison of Salary of Actors vs Actress

This dot plot shows the top paid actors and actresses and their respective salaries in 2017. We filtered this dataset by the 10 top ranked actors and actresses. From this graph we can see the top paid actor, Vin Diesel, made over 25 million dollars more than the top paid actress, Emma Stone.

```{r}

graph2_3 %>%
  ggplot(aes(x = Salary, y = fct_reorder(primaryName, Salary))) +
  geom_point() +
  ggtitle("Comparison of Salary of Actors vs Actress") +
  ylab("Actors/Actress")+
  xlab("$Salary In Millions")

```

## Frequency of movie genres

This graph shows the frequency of genres from the IMDb data. Drama and documentary are the leading genres with comedy as the third most frequent with less than half the value of drama and documentary. 

```{r}

graph4 <- read.csv('resources/uploading_data/graph4.csv')

graph4 %>%
  ggplot(aes(y = fct_rev(fct_infreq(genres)))) +
  geom_bar() +
  ggtitle("Frequency of movie genres") +
  ylab("Genres") +
  xlab("Count")

```

## Mosaic category and genre

From this Mosaic graph, we can see that there is an association between the category (editor, producer, and writer) and genres (action, comedy, and drama) because the number of movies in each category of genres changes depending on the category of the movie professionals.

```{r}

graph5 <- read.csv('resources/uploading_data/graph5.csv')

mosaic(genres~category, direction = c("v", "h"), graph5)

```

## Percentage of Genres From 2010 to 2020"

This line graph plots the percentage of genres over years from 2010 to 2020. While most genres remained relatively unchanged during this decade, drama and comedy had a steady decline and incline from 2010 to 2013, respectively. From 2017 to 2019 the reverse percent change. 

```{r}

graph6 <- read.csv('resources/uploading_data/graph6.csv')

graph6 %>%
  ggplot(aes(x = factor(startYear), y = per, group = genres, color = genres)) +
  geom_line() +
  ylab("Percentage of Genres")+
  xlab("Years")+
  ggtitle("Percentage of Genres From 2010 to 2020")+
  geom_point()

```

## Average Ratings Across Different Media

This boxplot shows the average rating across different media types. To our surprise, movies have the lowest median for average ratings while TV episodes have the highest median. While the spread for all media content is large, videos have the largest spread of average ratings.

```{r}

graph7 <- read.csv('resources/uploading_data/graph7.csv')

graph7 %>% 
  ggplot(aes(x = reorder(titleType, averageRating, median), y = averageRating)) +
  geom_boxplot(outlier.shape = NA) +
  coord_flip()+
  xlab("Media Type")+
  ylab("Average Ratings")+
  ggtitle("Average Ratings Across Different Media")+
  stat_boxplot(geom = "errorbar")

```

## Median Age of Actors/Actress From 1925 to 2020

In this graph we plotted the median age of lead actors and actresses from 1920 to 2021. Although the wage gap varies from year to year, the median age of lead actors is almost a decade older than that of actresses throughout all years. Also noticeable from this graph is the slight overall decrease in the wage gap from about 1990 onwards. 

```{r}

graph8 <- read.csv('resources/uploading_data/graph8.csv')

graph8 %>%
  filter(startYear >= 1920 & startYear <= 2020) %>% 
  ggplot(aes(x = startYear, fill = category)) +
          geom_ribbon(aes(ymin = low_age, ymax = high_age), alpha = 0.2) +
          scale_fill_manual(values = c( "blue", "pink"))+
          geom_line(aes(y = med_age, color = category)) +
          ylab("Median Age of Actors and Actress")+
          xlab("Years")+
          ggtitle("Median Age of Actors/Actress From 1925 to 2020")+
          scale_color_manual(values = c( "blue", "red"))

```

## Average Movie Run Time in Minutes From 1920 to 2020

This graph is a plot of average movie run time in minutes against years. From this graph we can see a steady increase in run time from 1920 to 2025. Overall runtime has increased by over 30 minutes from 1920 to 2025. The interesting information here is that the expected average movie run time drops by the year of 2020. 

```{r}

graph9 <- read.csv('resources/uploading_data/graph9.csv')

graph9 %>% 
  ggplot(aes(x = startYear, y = avgruntime)) +
  geom_line()+
  ylab("Average Movie Run Time in Minutes") +
  xlab("Years")+ 
  ggtitle("Average Movie Run Time in Minutes From 1920 to 2025")

```

## Movie Run Time Minutes From 1920 to 2020

This boxplot shows movie runtime from 1920 to 2020. Although we already saw runtime increased over time from the line graph above, from the box plots we can see the spread of movie runtime also increased overtime. We can see that the median run time for movies in 1920 is around 70 minutes, and the median run time for movies in 2020 has increased to approximately 90 minutes with maximum run time close to 150 minutes (2.5hours).

```{r}

graph10 <- read.csv('resources/uploading_data/graph10.csv')

graph10 %>% 
  ggplot(aes(x=factor(decade), y=runtimeMinutes)) +
  stat_boxplot(geom = "errorbar")+
  geom_boxplot(outlier.shape = NA)+
  ylab("Movie Run Time in Minutes") +
  xlab("Years")+
  ggtitle("Movie Run Time Minutes From 1920 to 2020")

```

## Number of Movies Released By Country

In this choropleth graph we plotted the total number of films released in each country from 1920 to 2020. It is visible from the graph that Canada, United States of America, Mexico, Brazil, Argentina, Western European countries, Russia, India, and Australia have the most film releases overall. Although not very visible from graph, India is the country with the most films released in the world.

```{r}

graph11 <- read.csv('resources/uploading_data/graph11.csv')

choroplethr::country_choropleth(graph11, title = "Number of Movies Released By Country", legend = "Number of Movies Released", num_colors = 7, zoom = NULL)

```

